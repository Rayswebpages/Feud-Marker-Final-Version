<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Classroom Feud - Question Mode</title>
    <style>
        /* --- RESET & BASICS --- */
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Arial Black', 'Impact', sans-serif; }
        body { 
            background-color: #0d1b3e; 
            color: white; 
            height: 100vh; 
            display: flex; 
            flex-direction: column;
            overflow: hidden; 
        }

        /* --- PROJECTOR VIEW --- */
        #game-board {
            flex: 1; 
            display: flex;
            flex-direction: column;
            background: radial-gradient(circle, #27458f 0%, #0d1b3e 100%);
            position: relative;
            padding: 10px; 
        }

        .battle-area {
            display: flex;
            justify-content: space-around;
            align-items: center;
            height: 100%;
            width: 100%;
        }

        .team-panel {
            background: rgba(0, 0, 0, 0.3);
            border: 4px solid #fcd015;
            border-radius: 15px;
            width: 42%; 
            height: 96%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center; 
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            position: relative;
            transition: all 0.3s ease;
        }

        .team-name {
            font-size: 3rem; 
            color: #fff;
            margin-bottom: 20px; 
            text-shadow: 2px 2px 0 #000;
            background: transparent;
            border: none;
            text-align: center;
            width: 100%;
        }
        .team-name:focus { outline: 2px solid #fcd015; background: rgba(0,0,0,0.5); }

        .score-box {
            background: linear-gradient(180deg, #000 0%, #1a1a1a 100%);
            border: 3px solid #666;
            color: #fcd015;
            font-size: 8rem; 
            padding: 20px 40px;
            border-radius: 15px;
            min-width: 260px;
            text-align: center;
            margin-bottom: 30px; 
            box-shadow: inset 0 0 20px rgba(0,0,0,0.8);
            text-shadow: 0 0 10px rgba(252, 208, 21, 0.5);
        }

        .strikes-area {
            display: flex;
            gap: 20px;
            height: 100px; 
        }

        .strike-slot {
            width: 80px; 
            height: 80px;
            background: rgba(255,255,255,0.1);
            border: 2px solid #444;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .strike-active {
            color: #ff0000;
            font-size: 5rem; 
            font-weight: bold;
            text-shadow: 0 0 15px red;
            animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        /* --- CENTER AREA: QUESTIONS & VS --- */
        .center-column {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            width: 10%;
        }

        .question-display {
            font-size: 2.5rem;
            color: #fcd015;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 20px;
            text-align: center;
            text-shadow: 0 0 10px rgba(252, 208, 21, 0.6);
            border-bottom: 2px solid #fff;
            padding-bottom: 5px;
            white-space: nowrap; /* Prevent wrapping */
        }

        .vs-badge {
            font-size: 4rem;
            color: rgba(255,255,255,0.2);
            font-weight: 900;
            font-style: italic;
        }

        /* --- GIANT STRIKE OVERLAY ANIMATION --- */
        #overlay-strike {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 100;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s;
        }
        .big-x {
            font-size: 25rem;
            color: #d11f1f;
            border: 10px solid #d11f1f;
            border-radius: 20px;
            padding: 0 40px;
            background: #fff;
            transform: scale(0);
            box-shadow: 0 0 50px red;
        }
        .animate-strike {
            animation: strikeFlash 1.5s ease-in-out;
        }

        /* --- STEAL DECISION MODAL --- */
        #steal-modal {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 200;
            display: none; 
            flex-direction: column;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(8px);
        }
        
        #steal-modal h2 {
            font-size: 3.5rem;
            color: white;
            margin-bottom: 20px;
            text-transform: uppercase;
            letter-spacing: 3px;
        }

        .steal-label {
            font-size: 3rem; 
            color: #aaa;
            margin-bottom: 10px;
            text-transform: uppercase;
        }

        .steal-score-val {
            font-size: 12rem; /* GIANT RED SCORE */
            color: #ff0000;
            font-weight: 900;
            margin-bottom: 40px;
            text-shadow: 0 0 30px rgba(255, 0, 0, 0.8);
            line-height: 1;
        }

        .steal-btn-row {
            display: flex;
            gap: 60px;
        }

        .big-action-btn {
            padding: 25px 60px;
            font-size: 3rem;
            border: 4px solid #fff;
            border-radius: 20px;
            cursor: pointer;
            text-transform: uppercase;
            transition: transform 0.2s;
        }
        .big-action-btn:hover { transform: scale(1.1); }
        .btn-steal { background-color: #fcd015; color: #000; border-color: #fcd015; font-weight: bold;}
        .btn-keep { background-color: #448aff; color: #fff; border-color: #448aff; font-weight: bold;}


        /* --- CONTROL PANEL --- */
        #controls {
            height: 20vh;
            background-color: #1a1a1a;
            border-top: 4px solid #fcd015;
            display: grid;
            grid-template-columns: 1fr 0.8fr 1fr;
            padding: 10px;
            gap: 10px;
        }

        .control-group {
            background: #333;
            padding: 10px;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .group-title {
            font-size: 0.8rem;
            color: #aaa;
            text-align: center;
            text-transform: uppercase;
        }

        .btn-row {
            display: flex;
            gap: 5px;
            flex: 1;
        }

        button.ctrl-btn {
            flex: 1;
            cursor: pointer;
            border: none;
            border-radius: 5px;
            font-weight: bold;
            font-size: 0.9rem;
            transition: transform 0.1s, filter 0.1s;
            text-transform: uppercase;
            color: #000;
            padding: 0 2px;
        }

        button.ctrl-btn:active { transform: scale(0.95); }
        button.ctrl-btn:hover { filter: brightness(1.1); }

        .btn-green { background-color: #4caf50; }
        .btn-orange { background-color: #ff9800; }
        .btn-red { background-color: #ff5252; }
        .btn-blue { background-color: #448aff; }
        .btn-yellow { background-color: #fcd015; }
        .btn-gray { background-color: #999; }
        .btn-purple { background-color: #9c27b0; color: white !important; }

        input[type="number"] {
            width: 100%;
            padding: 5px;
            font-size: 1.2rem;
            text-align: center;
            border: 2px solid #555;
            border-radius: 4px;
            background: #222;
            color: white;
        }

        /* --- ANIMATIONS --- */
        @keyframes popIn {
            0% { transform: scale(0); opacity: 0; }
            80% { transform: scale(1.2); opacity: 1; }
            100% { transform: scale(1); }
        }

        @keyframes strikeFlash {
            0% { transform: scale(0); opacity: 1; }
            15% { transform: scale(1.2); }
            20% { transform: scale(1); }
            80% { opacity: 1; transform: scale(1); }
            100% { opacity: 0; transform: scale(2); }
        }

        @keyframes scoreUpdate {
            0% { transform: scale(1); color: #fff; }
            50% { transform: scale(1.1); color: #fcd015; }
            100% { transform: scale(1); }
        }
        .score-anim { animation: scoreUpdate 0.4s ease; }

    </style>
</head>
<body>

    <!-- OVERLAY FOR BIG 'X' ANIMATION -->
    <div id="overlay-strike">
        <div class="big-x">X</div>
    </div>

    <!-- STEAL DECISION MODAL -->
    <div id="steal-modal">
        <h2 id="steal-title">TEAM B CHANCE TO STEAL!</h2>
        <div class="steal-label">Potential Score to Steal:</div>
        <div id="steal-score-val" class="steal-score-val">0</div>
        
        <div class="steal-btn-row">
            <button class="big-action-btn btn-steal" onclick="confirmSteal()">STEAL!</button>
            <button class="big-action-btn btn-keep" onclick="confirmKeep()">KEEP</button>
        </div>
    </div>

    <!-- PROJECTOR VIEW: GAME BOARD -->
    <div id="game-board">
        <div class="battle-area">
            <!-- TEAM A -->
            <div class="team-panel" id="panel-a">
                <input type="text" class="team-name" value="TEAM A" id="name-a">
                <div class="score-box" id="score-a">0</div>
                <div class="strikes-area" id="strikes-a">
                    <div class="strike-slot" data-slot="1"></div>
                    <div class="strike-slot" data-slot="2"></div>
                    <div class="strike-slot" data-slot="3"></div>
                </div>
            </div>

            <!-- CENTER INFO -->
            <div class="center-column">
                <div class="question-display" id="question-display">QUESTION 1</div>
                <div class="vs-badge">VS</div>
            </div>

            <!-- TEAM B -->
            <div class="team-panel" id="panel-b">
                <input type="text" class="team-name" value="TEAM B" id="name-b">
                <div class="score-box" id="score-b">0</div>
                <div class="strikes-area" id="strikes-b">
                    <div class="strike-slot" data-slot="1"></div>
                    <div class="strike-slot" data-slot="2"></div>
                    <div class="strike-slot" data-slot="3"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- TEACHER CONTROLS -->
    <div id="controls">
        
        <!-- TEAM A CONTROLS -->
        <div class="control-group">
            <div class="group-title">Team A Controls</div>
            <input type="number" id="input-score-a" placeholder="Points">
            <div class="btn-row">
                <button class="ctrl-btn btn-green" onclick="addScore('a')">Add</button>
                <button class="ctrl-btn btn-orange" onclick="subtractScore('a')">Sub</button>
                <button class="ctrl-btn btn-red" onclick="addStrike('a')">Strike</button>
                <button class="ctrl-btn btn-gray" onclick="clearStrikes('a')">Clr X</button>
            </div>
        </div>

        <!-- GLOBAL CONTROLS -->
        <div class="control-group">
            <div class="group-title">Game Master</div>
            <div class="btn-row">
                <button class="ctrl-btn btn-purple" onclick="nextQuestion()">Next Question</button>
            </div>
            <div class="btn-row">
                <button class="ctrl-btn btn-yellow" onclick="clearAllStrikes()">Clear X</button>
                <button class="ctrl-btn btn-blue" onclick="resetGame()">Reset</button>
            </div>
        </div>

        <!-- TEAM B CONTROLS -->
        <div class="control-group">
            <div class="group-title">Team B Controls</div>
            <input type="number" id="input-score-b" placeholder="Points">
            <div class="btn-row">
                <button class="ctrl-btn btn-green" onclick="addScore('b')">Add</button>
                <button class="ctrl-btn btn-orange" onclick="subtractScore('b')">Sub</button>
                <button class="ctrl-btn btn-red" onclick="addStrike('b')">Strike</button>
                <button class="ctrl-btn btn-gray" onclick="clearStrikes('b')">Clr X</button>
            </div>
        </div>

    </div>

    <script>
        // State
        const state = {
            question: 1, // Changed from round to question
            // Pending steal logic
            victimTeam: null,
            thiefTeam: null,
            
            a: { score: 0, strikes: 0, roundScore: 0 },
            b: { score: 0, strikes: 0, roundScore: 0 }
        };

        // --- SCORES ---

        function addScore(team) {
            const input = document.getElementById(`input-score-${team}`);
            const val = parseInt(input.value);
            
            if (!isNaN(val)) {
                state[team].score += val;
                state[team].roundScore += val; // Track for stealing
                updateScoreDisplay(team);
                input.value = ''; 
                input.focus();
            }
        }

        function subtractScore(team) {
            const input = document.getElementById(`input-score-${team}`);
            const val = parseInt(input.value);
            
            if (!isNaN(val)) {
                state[team].score -= val;
                state[team].roundScore -= val; // Track for stealing
                updateScoreDisplay(team);
                input.value = ''; 
                input.focus();
            }
        }

        function updateScoreDisplay(team) {
            const el = document.getElementById(`score-${team}`);
            el.innerText = state[team].score;
            el.classList.remove('score-anim');
            void el.offsetWidth;
            el.classList.add('score-anim');
        }

        // --- QUESTIONS (Formerly Rounds) ---

        function nextQuestion() {
            if(confirm("Start Next Question? (This clears strikes and accumulated steal points)")) {
                state.question++;
                document.getElementById('question-display').innerText = `QUESTION ${state.question}`;
                
                // Reset accumulators for the new question
                state.a.roundScore = 0;
                state.b.roundScore = 0;
                
                // Clear strikes for visual cleanliness
                clearAllStrikes();
            }
        }

        // --- STRIKES & STEAL LOGIC ---

        function addStrike(team) {
            if (state[team].strikes < 3) {
                state[team].strikes++;
                
                // Play animation
                triggerOverlayStrike();
                updateStrikeDisplay(team);

                // CHECK FOR STEAL CONDITION (3rd Strike)
                if (state[team].strikes === 3) {
                    setTimeout(() => {
                        triggerStealModal(team);
                    }, 1600); // Wait for X animation to finish
                }
            } else {
                triggerOverlayStrike();
            }
        }

        function triggerStealModal(victim) {
            state.victimTeam = victim;
            state.thiefTeam = (victim === 'a') ? 'b' : 'a';

            const thiefName = document.getElementById(`name-${state.thiefTeam}`).value;
            const pointsToSteal = state[victim].roundScore;

            // Update text elements
            document.getElementById('steal-title').innerText = `${thiefName} CHANCE TO STEAL!`;
            document.getElementById('steal-score-val').innerText = pointsToSteal; // Giant Red Number
            
            document.getElementById('steal-modal').style.display = 'flex';
        }

        function confirmSteal() {
            const victim = state.victimTeam;
            const thief = state.thiefTeam;
            const amount = state[victim].roundScore;

            // Transfer points
            state[victim].score -= amount;
            state[thief].score += amount;

            // Reset question scores (stealing effectively ends the question logic for that team)
            state[victim].roundScore = 0; 
            
            updateScoreDisplay(victim);
            updateScoreDisplay(thief);

            closeModal();
        }

        function confirmKeep() {
            // Do nothing to scores
            closeModal();
        }

        function closeModal() {
            document.getElementById('steal-modal').style.display = 'none';
        }

        function clearStrikes(team) {
            state[team].strikes = 0;
            updateStrikeDisplay(team);
        }

        function clearAllStrikes() {
            clearStrikes('a');
            clearStrikes('b');
        }

        function updateStrikeDisplay(team) {
            const container = document.getElementById(`strikes-${team}`);
            const slots = container.querySelectorAll('.strike-slot');
            const count = state[team].strikes;

            slots.forEach((slot, index) => {
                if (index < count) {
                    slot.innerHTML = '<span class="strike-active">X</span>';
                } else {
                    slot.innerHTML = '';
                }
            });
        }

        function triggerOverlayStrike() {
            const overlay = document.getElementById('overlay-strike');
            const bigX = overlay.querySelector('.big-x');
            
            overlay.style.opacity = '1';
            bigX.classList.add('animate-strike');

            setTimeout(() => {
                overlay.style.opacity = '0';
                bigX.classList.remove('animate-strike');
            }, 1500);
        }

        // --- RESET ---

        function resetGame() {
            if(confirm("FULL RESET: Clear scores, strikes, and question number?")) {
                state.question = 1;
                document.getElementById('question-display').innerText = "QUESTION 1";
                
                state.a.score = 0; state.a.strikes = 0; state.a.roundScore = 0;
                state.b.score = 0; state.b.strikes = 0; state.b.roundScore = 0;
                
                updateScoreDisplay('a');
                updateScoreDisplay('b');
                updateStrikeDisplay('a');
                updateStrikeDisplay('b');
                
                document.getElementById('name-a').value = "TEAM A";
                document.getElementById('name-b').value = "TEAM B";
            }
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.shiftKey && e.key.toLowerCase() === 'a') addStrike('a');
            if (e.shiftKey && e.key.toLowerCase() === 'b') addStrike('b');
        });

    </script>
</body>
</html>